<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:sec="https://joinfaces.org/security"
	
	template="/WEB-INF/jsf/base.xhtml"
	lang="cs">

	<ui:define name="scripts">
		<script src="${pageContext.request.contextPath}/webjars/sockjs-client/sockjs.min.js"></script>
		<script src="${pageContext.request.contextPath}/webjars/stomp-websocket/stomp.min.js"></script>
		<script src="${pageContext.request.contextPath}/wsock/app.js"></script>
	</ui:define>

	<ui:define name="title">WebSocket Client</ui:define>
	
	<ui:define name="body">
		<h1>Home</h1>
		<sec:authorize access="isAnonymous()">
			<p>You are anonymous, <a href="/login">login</a></p>
		</sec:authorize>
		<sec:authorize access="isAuthenticated()">
			<form action="/logout" method="post">
				<p>
					You are authenticated, <button type="submit" class="btn btn-link">logout</button>
					<input type="hidden" name="#{_csrf.parameterName}" value="#{_csrf.token}"/>
				</p>
			</form>
		</sec:authorize>
		<sec:authorize access="hasRole('ADMIN')">
			<p>You are an admin</p>
		</sec:authorize>

		<div class="row">
			<div class="col-md-6">
				<form class="form-inline">
					<div class="form-group">
						<label for="connect">WebSocket connection:</label>
						<button id="connect" class="btn btn-default" data-csrf="#{_csrf.token}" type="submit">Connect</button>
						<button id="disconnect" class="btn btn-default" type="submit" disabled="disabled">Disconnect
						</button>
					</div>
				</form>
			</div>
			<div class="col-md-6">
				<form class="form-inline">
					<div class="form-group">
						<label for="name">What is your name?</label>
						<input type="text" id="name" class="form-control" placeholder="Your name here..."/>
					</div>
					<button id="send" class="btn btn-default" type="submit">Send</button>
				</form>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<table id="conversation" class="table table-striped">
					<thead>
					<tr>
						<th>Greetings</th>
					</tr>
					</thead>
					<tbody id="greetings">
					</tbody>
				</table>
			</div>
		</div>
	</ui:define>
	
</ui:composition>
